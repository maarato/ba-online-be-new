{
  "name": "decide_next_and_ask",
  "role": "user",
  "content": [
    "Tarea: Con base en `conversation_state`, decide si ya están todos los slots. Si faltan, elige el PRÓXIMO slot vacío (orden 1→9) y genera UNA pregunta breve para ese slot. Si están todos completos, `finalizar = true`.",
    "",
    "Estado actual:",
    "{{conversation_state_json}}",
    "",
    "Orden de slots:",
    "1) idea_negocio",
    "2) usuarios_objetivos",
    "3) region_operacion",
    "4) market_scope",
    "5) modelo_ingresos",
    "6) tipo_producto",
    "7) integraciones",
    "8) timeline",
    "9) capital_inicial",
    "",
    "Guías de redacción:",
    "- Redacta una confirmación más completa (2–3 frases) cuando el turno anterior aportó información, reconociendo lo dicho y encajándolo en el slot.",
    "- Pregunta: una sola, breve, concreta y accionable. Añade ejemplo si ayuda.",
    "- Para 'usuarios_objetivos': pregunta quiénes serán los usuarios del sistema a desarrollar (roles/perfiles, clientes internos/externos). Pide un ejemplo si ayuda.",
    "- Para 'tipo_producto': aclara si el sistema de software será el producto final, si facilitará el acceso al producto (p.ej., e-commerce, marketplace), o si apoyará operaciones internas (p.ej., ERP, CRM, automatización). Formula la pregunta para que el usuario elija/describe una de estas opciones.",
    "- Para 'integraciones': pregunta si el sistema debe integrarse con herramientas/sistemas/fuentes de datos existentes (p.ej., ERP, CRM, pasarelas de pago, proveedores externos, APIs). Pide ejemplos concretos si existen.",
    "- Evita frases de error o indisponibilidad (p.ej., 'hubo un error', 'servicio no disponible', 'lo siento…').",
    "- Si el estado usa nombres distintos a los canónicos, ADÁPTATE silenciosamente. No comentes desalineaciones; decide el próximo slot usando el orden canónico.",
    "- No pidas más de un dato a la vez.",
    "- Si recibes 'Próximo slot vacío canónico: X', DEBES preguntar exactamente por X y establecer `slot_actual = X`.",
    "",
    "Salida (JSON):",
    "{",
    "  \"finalizar\": <true|false>,",
    "  \"slot_actual\": \"<nombre_slot_o_null>\",",
    "  \"pregunta\": \"<si finalizar=false, aquí va la pregunta>\",",
    "  \"confirmacion_breve\": \"<si el turno anterior aportó algo, una reformulación 2–3 frases o vacío>\"",
    "}"
  ],
  "temperature": 0.2
}
